<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Enhanced Reading and Writing for SQLite Databases â€¢ readwritesqlite</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Enhanced Reading and Writing for SQLite Databases">
<meta property="og:description" content="Reads and writes data frames to SQLite databases
    while preserving time zones (for POSIXct columns), projections (for
    sfc columns), units (for units columns), levels (for factors and
    ordered factors) and classes for logical, Date and hms columns.  It
    also logs changes to tables and provides more informative error
    messages.">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">readwritesqlite</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.2.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/using-readwritesqlite.html">Using readwritesqlite</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/poissonconsulting/readwritesqlite/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">

<div class="section level1">
<div class="page-header"><h1 id="readwritesqlite-">readwritesqlite <img src="reference/figures/logo.png" style="float: right"><a class="anchor" aria-label="anchor" href="#readwritesqlite-"></a>
</h1></div>
<!-- badges: start -->
</div>
<div class="section level1">
<h1 id="readwritesqlite">readwritesqlite<a class="anchor" aria-label="anchor" href="#readwritesqlite"></a>
</h1>
<p>SQLite databases are a simple, powerful way to validate, query and store related data frames particularly when used with the RSQLite package. However, current solutions do not preserve (or check) meta data, log changes or provide particularly useful error messages.</p>
<p><code>readwritesqlite</code> is an R package that by default</p>
<ul>
<li>preserves (and subsequently checks) the following metadata<ul>
<li>the class for logical, Date and hms columns</li>
<li>the levels for factors and ordered factors</li>
<li>the time zone for POSIXct columns</li>
<li>the units for unit columns</li>
<li>the projection for sfc columns</li>
<li>the sf column for sf objects</li>
</ul>
</li>
<li>logs<ul>
<li>the date time</li>
<li>system user</li>
<li>table creation and data insertion or deletion</li>
</ul>
</li>
<li>provides informative error messages if<ul>
<li>columns are missing</li>
<li>NOT NULL columns contain missing values</li>
<li>PRIMARY KEY column values in the input data are not unique</li>
</ul>
</li>
</ul>
<p><code>readwritesqlite</code> also allows the user to</p>
<ul>
<li>write environments (or named lists) of data frames (useful for populating databases)</li>
<li>delete existing data (and meta data) before writing (useful for converting an existing database)</li>
<li>replace existing data which causes unique or primary key conflicts (useful for updating databases)</li>
<li>confirm data can be written without committing any changes (useful for checking data)</li>
<li>check all existing tables are written to (useful for data transfers)</li>
<li>rearrange and add levels for factors and add levels for ordered factors</li>
<li>initialize the meta data for a new table by writing a data frame or sf data frame with no rows but logical, Date, factor, ordered, POSIXct, sfc or unit columns (useful for creating an empty database with additional informative checks)</li>
</ul>
<p><code>readwritesqlite</code> provides all these features through its <code><a href="reference/rws_write.html">rws_write()</a></code> and <code><a href="reference/rws_read.html">rws_read()</a></code> functions.</p>
<p>The <code><a href="reference/rws_query.html">rws_query()</a></code> function allows the user to pass a SQL query. By default, the metadata (except the setting of the sf column) is, if unambiguously defined, preserved for each column in the final query. To enable this functionality the user should ensure that a) columns in tables which will be referenced in the same query should have different names or identical metadata and b) column names in the final query should match those in the referenced base tables.</p>
<p>The init, meta and log data are stored in separate tables from the main data which means that they do not interfere with other ways of interacting with a SQLite database.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>To install the latest release from <a href="https://cran.r-project.org" class="external-link">CRAN</a></p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"readwritesqlite"</span><span class="op">)</span></span></code></pre></div>
<p>To install the developmental version from <a href="https://github.com/poissonconsulting/readwritesqlite" class="external-link">GitHub</a></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("remotes")</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"poissonconsulting/readwritesqlite"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="demonstration">Demonstration<a class="anchor" aria-label="anchor" href="#demonstration"></a>
</h2>
<p>Key attribute information is preserved for many classes.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/poissonconsulting/readwritesqlite" class="external-link">readwritesqlite</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># for nicer printing of data frames</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Linking to GEOS 3.11.0, GDAL 3.5.1, PROJ 9.0.1; sf_use_s2() is TRUE</span></span>
<span></span>
<span><span class="va">conn</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/rws_connect.html">rws_connect</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rws_data</span> <span class="op">&lt;-</span> <span class="fu">readwritesqlite</span><span class="fu">::</span><span class="va"><a href="reference/rws_data.html">rws_data</a></span></span>
<span><span class="va">rws_data</span></span>
<span><span class="co">#&gt; # A tibble: 3 Ã— 6</span></span>
<span><span class="co">#&gt;   logical date       factor ordered posixct             units</span></span>
<span><span class="co">#&gt;   &lt;lgl&gt;   &lt;date&gt;     &lt;fct&gt;  &lt;ord&gt;   &lt;dttm&gt;                [m]</span></span>
<span><span class="co">#&gt; 1 TRUE    2000-01-01 x      x       2001-01-02 03:04:05  10  </span></span>
<span><span class="co">#&gt; 2 FALSE   2001-02-03 y      y       2006-07-08 09:10:11  11.5</span></span>
<span><span class="co">#&gt; 3 NA      NA         &lt;NA&gt;   &lt;NA&gt;    NA                   NA</span></span>
<span></span>
<span><span class="fu"><a href="reference/rws_write.html">rws_write</a></span><span class="op">(</span><span class="va">rws_data</span>, exists <span class="op">=</span> <span class="cn">FALSE</span>, conn <span class="op">=</span> <span class="va">conn</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="reference/rws_read_table.html">rws_read_table</a></span><span class="op">(</span><span class="st">"rws_data"</span>, conn <span class="op">=</span> <span class="va">conn</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 3 Ã— 6</span></span>
<span><span class="co">#&gt;   logical date       factor ordered posixct             units</span></span>
<span><span class="co">#&gt;   &lt;lgl&gt;   &lt;date&gt;     &lt;fct&gt;  &lt;ord&gt;   &lt;dttm&gt;                [m]</span></span>
<span><span class="co">#&gt; 1 TRUE    2000-01-01 x      x       2001-01-02 03:04:05  10  </span></span>
<span><span class="co">#&gt; 2 FALSE   2001-02-03 y      y       2006-07-08 09:10:11  11.5</span></span>
<span><span class="co">#&gt; 3 NA      NA         &lt;NA&gt;   &lt;NA&gt;    NA                   NA</span></span></code></pre></div>
<p>The attribute information is stored in the metadata table</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/rws_read_meta.html">rws_read_meta</a></span><span class="op">(</span>conn <span class="op">=</span> <span class="va">conn</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 Ã— 4</span></span>
<span><span class="co">#&gt;   TableMeta ColumnMeta MetaMeta          DescriptionMeta</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;     &lt;chr&gt;      &lt;chr&gt;             &lt;chr&gt;          </span></span>
<span><span class="co">#&gt; 1 RWS_DATA  DATE       class: Date       &lt;NA&gt;           </span></span>
<span><span class="co">#&gt; 2 RWS_DATA  FACTOR     factor: 'x', 'y'  &lt;NA&gt;           </span></span>
<span><span class="co">#&gt; 3 RWS_DATA  LOGICAL    class: logical    &lt;NA&gt;           </span></span>
<span><span class="co">#&gt; 4 RWS_DATA  ORDERED    ordered: 'y', 'x' &lt;NA&gt;           </span></span>
<span><span class="co">#&gt; 5 RWS_DATA  POSIXCT    tz: Etc/GMT+8     &lt;NA&gt;           </span></span>
<span><span class="co">#&gt; 6 RWS_DATA  UNITS      units: m          &lt;NA&gt;</span></span></code></pre></div>
<p>The user can add descriptions if they wish.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/rws_describe_meta.html">rws_describe_meta</a></span><span class="op">(</span><span class="st">"rws_data"</span>, <span class="st">"posixct"</span>, <span class="st">"The time of a visit"</span>, conn <span class="op">=</span> <span class="va">conn</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/rws_describe_meta.html">rws_describe_meta</a></span><span class="op">(</span><span class="st">"rws_data"</span>, <span class="st">"units"</span>, <span class="st">"The site length."</span>, conn <span class="op">=</span> <span class="va">conn</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/rws_read_meta.html">rws_read_meta</a></span><span class="op">(</span>conn <span class="op">=</span> <span class="va">conn</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 Ã— 4</span></span>
<span><span class="co">#&gt;   TableMeta ColumnMeta MetaMeta          DescriptionMeta    </span></span>
<span><span class="co">#&gt;   &lt;chr&gt;     &lt;chr&gt;      &lt;chr&gt;             &lt;chr&gt;              </span></span>
<span><span class="co">#&gt; 1 RWS_DATA  DATE       class: Date       &lt;NA&gt;               </span></span>
<span><span class="co">#&gt; 2 RWS_DATA  FACTOR     factor: 'x', 'y'  &lt;NA&gt;               </span></span>
<span><span class="co">#&gt; 3 RWS_DATA  LOGICAL    class: logical    &lt;NA&gt;               </span></span>
<span><span class="co">#&gt; 4 RWS_DATA  ORDERED    ordered: 'y', 'x' &lt;NA&gt;               </span></span>
<span><span class="co">#&gt; 5 RWS_DATA  POSIXCT    tz: Etc/GMT+8     The time of a visit</span></span>
<span><span class="co">#&gt; 6 RWS_DATA  UNITS      units: m          The site length.</span></span></code></pre></div>
<p>The log provides a record of data changes that have been made using readwritesqlite.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/rws_read_log.html">rws_read_log</a></span><span class="op">(</span>conn <span class="op">=</span> <span class="va">conn</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 2 x 5</span></span>
<span><span class="co">#&gt;   DateTimeUTCLog      UserLog TableLog CommandLog NRowLog</span></span>
<span><span class="co">#&gt;   &lt;dttm&gt;              &lt;chr&gt;   &lt;chr&gt;    &lt;chr&gt;        &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1 2019-07-07 16:05:10 joe     RWS_DATA CREATE           0</span></span>
<span><span class="co">#&gt; 2 2019-07-07 16:05:11 joe     RWS_DATA INSERT           3</span></span></code></pre></div>
<p>Donâ€™t forget to disconnect when done.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/rws_disconnect.html">rws_disconnect</a></span><span class="op">(</span><span class="va">conn</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="information">Information<a class="anchor" aria-label="anchor" href="#information"></a>
</h2>
<p>For more information on using <code>readwritesqlite</code> see the vignette <a href="https://poissonconsulting.github.io/readwritesqlite/articles/using-readwritesqlite.html" class="external-link">using-readwritesqlite</a>.</p>
</div>
<div class="section level2">
<h2 id="contribution">Contribution<a class="anchor" aria-label="anchor" href="#contribution"></a>
</h2>
<p>Please report any <a href="https://github.com/poissonconsulting/readwritesqlite/issues" class="external-link">issues</a>.</p>
<p><a href="https://github.com/poissonconsulting/readwritesqlite/pulls" class="external-link">Pull requests</a> are always welcome.</p>
</div>
<div class="section level2">
<h2 id="code-of-conduct">Code of Conduct<a class="anchor" aria-label="anchor" href="#code-of-conduct"></a>
</h2>
<p>Please note that the readwritesqlite project is released with a <a href="https://contributor-covenant.org/version/2/0/CODE_OF_CONDUCT.html" class="external-link">Contributor Code of Conduct</a>. By contributing to this project, you agree to abide by its terms.</p>
</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=readwritesqlite" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/poissonconsulting/readwritesqlite/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/poissonconsulting/readwritesqlite/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
<li><a href="SUPPORT.html">Getting help</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing readwritesqlite</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Joe Thorley <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-7683-4592" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Poisson Consulting <br><small class="roles"> Copyright holder, funder </small>  </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://lifecycle.r-lib.org/articles/stages.html#stable" class="external-link"><img src="https://img.shields.io/badge/lifecycle-stable-brightgreen.svg" alt="Lifecycle: stable"></a></li>
<li><a href="https://github.com/poissonconsulting/readwritesqlite/actions" class="external-link"><img src="https://github.com/poissonconsulting/readwritesqlite/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://codecov.io/github/poissonconsulting/readwritesqlite?branch=master" class="external-link"><img src="https://codecov.io/gh/poissonconsulting/readwritesqlite/branch/master/graph/badge.svg" alt="Coverage status"></a></li>
<li><a href="https://opensource.org/licenses/MIT" class="external-link"><img src="https://img.shields.io/badge/License-MIT-green.svg" alt="License: MIT"></a></li>
<li><a href="https://cran.r-project.org/package=readwritesqlite" class="external-link"><img src="https://www.r-pkg.org/badges/version/readwritesqlite" alt="CRAN status"></a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Joe Thorley, Poisson Consulting.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.9000.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
